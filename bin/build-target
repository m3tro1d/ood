#!/usr/bin/env bash

if [ -z "$1" ]; then
  echo "usage: $0 [cmake target]"
  exit 1
fi

BUILD_DIRECTORY="$PWD/cmake-build"

mkdir -p "$BUILD_DIRECTORY"

USER_ID=$(id -u)

docker run -t -i \
  --user "$USER_ID" \
  -v /etc/passwd:/etc/passwd:ro \
  -v /etc/group:/etc/group:ro \
  -v ${PWD}:/app/src \
  -v ${BUILD_DIRECTORY}:/app/build \
  ood-builder \
  $1
